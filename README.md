# JavaScript `this` parameter

> `this` isn't really a keyword, it is the natural "main" function argument in JavaScript.
> - (@spion)[https://github.com/mindeavor/es-pipeline-operator/issues/2#issuecomment-162348536]

This proposal extends the `function` declaration syntax to allow explicit `this` parameter, which TypeScript/Flow already support.

```ts
// TypeScript this parameter
function getX<T>(this: T) {
	return this.x
}
```

```js
// JavaScript this parameter
function getX(this) {
	return this.x
}
```

Status: Stage 0

Author: @hax (HE Shi-Jun), @gilbert

There is an old proposal [gilbert/es-explicit-this](https://github.com/gilbert/es-explicit-this) presented in Feb 2020 TC39 meeting but not advanced. This revised version drop the features of renaming and destructuring `this` in the old proposal, only focus on the basic feature of `this` parameter syntax which TypeScript/Flow already support.

[Type Annotation proposal](https://github.com/tc39/proposal-type-annotations/blob/a4315be8a311980ca525dc539585b10b7478a63e/README.md#this-parameters) also include this feature, but strictly speaking, `this` parameter itself is not annotation, and could have runtime semantic which type annotation proposal intentionally avoid, so it's better to specced in this seperate proposal.

## Motivation

Explicit `this` parameter allow type annotation or parameter decorators be added just like normal parameter.

```ts
// Type annotation (TypeScript, already possible today)
Number.prototype.toHexString = function (this: number) {
  return this.toString(16)
}
```

```ts
// Parameter decorators (future proposal)
Number.prototype.toHexString = function (@toNumber this) {
  return this.toString(16) // same as Number(num).toString(16)
}
```

## Early errors

Class constructor can't use explicit `this` syntax because class constructor can only be used via `new` and `this` in the constructor is never a parameter or argument passed by caller, the `this` value in constructor is generated by the constructor or its base class.

```js
class C {
  constructor(this) { // <-- Syntax error!
    // ...
  }
}
```

## Runtime errors:

If a function has `this` parameter, it could be useful to throw an error when that function gets called without one or used via `new`. For example:

```js
function zip (this, otherArray) {
  return this.map( (a, i) => [a, otherArray[i]] )
}

zip() //=> Throws a TypeError on invocation,
      //   before `array.map(...)` is run.

new zip() //=> Also throws a TypeError
```

